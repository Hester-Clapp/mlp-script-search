<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ScriptSearch - My Little Pony Friendship Is Magic</title>
    <style>
        label {
            display: block;
            margin-bottom: 10px;
        }

        input#queryField {
            width: 70%;
            padding: 8px;
            box-sizing: border-box;
            border-radius: 8px;
            border: 1px solid #ccc;
        }

        fieldset {
            width: fit-content;
        }

        input[type="radio"] {
            margin-right: 5px;
        }

        input[type="radio"]+input {
            display: none;
            width: 8ch;
            padding: 4px;
            box-sizing: border-box;
            border-radius: 4px;
            border: 1px solid #ccc;
        }

        input:checked+input {
            display: inline;
        }

        button[type="submit"] {
            display: block;
            padding: 10px 15px;
            font-size: 20px;
            background-color: #EC0B8F;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 15px auto;
        }

        #results>h2 {
            margin: 0;
        }

        #results>details {
            margin: 2rem;
            padding: 0;
            background-color: #f9f9f9;
            border-radius: 15px;
            border: 1rem solid #EC0B8F;
        }

        #results>details summary {
            margin-top: 0;
            padding: 0.5rem;
            color: white;
            cursor: pointer;
        }

        #results>details summary h3 {
            display: inline;
            margin: 0 1ch;
        }

        #results>details p {
            margin: 1rem;
        }

        span.match {
            color: #00B1CC;
        }
    </style>
</head>

<body>
    <div style="width: 60%; margin: auto; padding: 20px; border: 1px solid #ccc; border-radius: 5px;">
        <h1>ScriptSearch</h1>
        <form action="/search" method="POST">
            <label>
                Search Query:
                <input id="queryField" type="text" name="query" placeholder="I'd like to be a tree" required
                    autocomplete="off">
            </label>
            <div style="display:flex;">
                <fieldset>
                    <legend>Mode:</legend>
                    <label title="Search for lines with the exact phrase entered">
                        Exact
                        <input type="radio" name="mode" value="exact" checked>
                    </label>
                    <label
                        title="Search for a sequence of scenes that can be spliced together to form the sentence entered">
                        Sentence
                        <input type="radio" name="mode" value="sentence">
                    </label>
                    <label title="Search for lines matching a regular expression">
                        Regex
                        <input type="radio" name="mode" value="regex">
                        <input type="text" name="flags" placeholder="flags" autocomplete="off">
                    </label>
                </fieldset>
                <label style="margin-left: 2rem;">
                    Character:
                    <input type="text" name="speaker" list="speakersList" placeholder="Any" autocomplete="off"
                        id="speakerField">
                    <datalist id="speakersList">
                        <option value="Any" selected>
                        <option value="Twilight Sparkle">
                        <option value="Applejack">
                        <option value="Fluttershy">
                        <option value="Rarity">
                        <option value="Pinkie Pie">
                        <option value="Rainbow Dash">
                    </datalist>
                    <img id="speakerImg" src="default_pony.png" alt="" style="display: block; height: 6rem;">
                </label>
            </div>
            <button type="submit">&#x1F50D;&#xFE0E; Search</button>
        </form>
    </div>
    <div style="width: 80%; margin: 1rem auto; padding: 20px; border: 1px solid #ccc; border-radius: 5px;">
        <h2>Search Results:</h2>
        <div id="phrases"></div>
        <div id="results"></div>
        <button id="loadMore" style="display: none;">Load More</button>
    </div>
</body>
<script>
    const speakers = [
        "Unknown",
        "Narrator",
        "Narrator, Twilight Sparkle",
        "Twilight Sparkle",
        "Twinkleshine",
        "Spike",
        "Royal guards",
        "Pinkie Pie",
        "Applejack",
        "Granny Smith",
        "Apple Bloom",
        "Apple family",
        "Rainbow Dash",
        "Rarity",
        "Fluttershy",
        "Ponies",
        "Mayor Mare",
        "Nightmare Moon",
        "Mane Six",
        "Fluttershy, Rainbow Dash, Rarity",
        "Manny Roar",
        "Mane Six except Fluttershy",
        "Steven Magnet",
        "Shadowbolt Leader",
        "Applejack, Fluttershy, Pinkie Pie, Rainbow Dash, Rarity",
        "Princess Celestia",
        "Princess Luna",
        "Rainbow Dash, Twilight Sparkle",
        "Applejack, Twilight Sparkle",
        "Applejack, Rainbow Dash",
        "Pinkie Pie, Rarity",
        "Mane Six except Twilight",
        "Savoir Fare",
        "Drizzle",
        "Daisy",
        "Shoeshine",
        "Mane Six except Applejack",
        "Mane Six except Twilight Sparkle",
        "Big McIntosh",
        "Sweetie Drops",
        "Winona",
        "DaisyJo",
        "Mrs Cake",
        "Mr Cake",
        "Nurse Redheart",
        "Mule",
        "Lily Valley",
        "Rose",
        "Pinkie Pie, Rainbow Dash",
        "Gilda",
        "Gilda, Rainbow Dash",
        "Merry May",
        "Pony",
        "Snails",
        "Snips",
        "Trixie",
        "Audience",
        "Snails, Snips",
        "Golden Harvest",
        "Ursa",
        "Snails, Snips, Trixie",
        "Unidentified cow",
        "Applejack, Rainbow Dash, Rarity",
        "Snails, Snips, Spike",
        "Angel",
        "Applejack, Pinkie Pie, Rarity",
        "Razer",
        "Applejack, Rarity",
        "Applejack, Rarity, Twilight",
        "Twilight",
        "Applejack, Fluttershy, Rainbow Dash",
        "Zecora",
        "Applejack, Pinkie Pie, Rainbow Dash, Rarity",
        "Spike, Twilight Sparkle",
        "Fluttershy, Pinkie Pie, Rarity, Twilight Sparkle",
        "Apple Bloom, Zecora",
        "Lotus Blossom",
        "All",
        "Parasprite",
        "Parasprites",
        "Rainbow Dash, Rarity, Twilight Sparkle",
        "Parasprite, Spike",
        "Gardening pony",
        "Applejack, Fluttershy, Rainbow Dash, Rarity",
        "Pinkie Pie, Twilight Sparkle",
        "Hedgehogs",
        "Porcupines",
        "Snakes",
        "Applejack, Spike",
        "Caramel",
        "Rainbowshine",
        "Cheerilee",
        "Diamond Tiara",
        "Twist",
        "Cherilee",
        "Silver Spoon",
        "Diamond Tiara, Silver Spoon",
        "Dr Hooves",
        "Ace Point",
        "Roller ponies",
        "Berryshine",
        "Scootaloo",
        "Sweetie Belle",
        "Tornado Bolt",
        "Pi√±a Colada",
        "Coronet",
        "Opalescence",
        "Applejack, Rainbow Dash, Twilight Sparkle",
        "Mane Six except Rarity",
        "Applejack, Fluttershy, Pinkie Pie, Rainbow Dash",
        "Hoity Toity",
        "Dumb-Bell",
        "Hoops",
        "Dumb-Bell, Hoops, Score",
        "Score",
        "Applejack, Pinkie Pie, Rarity, Twilight Sparkle",
        "Group",
        "Steam Roller",
        "Foggy Fleece",
        "Madden",
        "Lucy Packard",
        "Meadow Song",
        "Misty Fly",
        "Soarin",
        "Spitfire",
        "Applejack, Pinkie Pie, Twilight Sparkle",
        "Fluttershy, Rarity",
        "Apple Bloom, Scootaloo",
        "Cutie Mark Crusaders",
        "Apple Bloom, Sweetie Belle",
        "Cockatrice",
        "Cutie Mark Crusaders, Fluttershy",
        "Fluttershy, Twilight Sparkle",
        "Frou Frou",
        "Peachy Pie, Sunny Daze",
        "Peachy Pie",
        "Sunny Daze",
        "Sapphire Shores",
        "Rover",
        "Fido",
        "Diamond Dogs",
        "Spot",
        "Sir Spike",
        "Mook dogs",
        "Lady Rarity",
        "Fido, Spot",
        "Mook dog",
        "Photo Finish",
        "Background voice",
        "Lyrica Lilac",
        "Royal Ribbon",
        "Gala Appleby",
        "Lemon Hearts",
        "Fluttershy, Pinkie Pie, Rainbow Dash",
        "Fluttershy, Pinkie Pie, Rainbow Dash, Twilight Sparkle",
        "Little Strongheart",
        "Braeburn",
        "Black Stone",
        "Noteworthy",
        "Morton Saltworthy",
        "Ol' Salt",
        "Buffalo",
        "Chief Thunderhooves",
        "Sheriff Silverstar",
        "Goldengrape",
        "Fluttershy, Rainbow Dash, Rarity, Spike, Twilight Sparkle",
        "Settler ponies",
        "Cherry Berry",
        "Mouse family",
        "Guard 1",
        "Guard 2",
        "Philomena",
        "Guard",
        "Hummingway",
        "Count Caesar",
        "Young Applejack",
        "Aunt Orange",
        "Uncle Orange",
        "Tall Order",
        "Dane Tee Dove",
        "Young Fluttershy",
        "Young Dumb-Bell",
        "Young Hoops",
        "Young Rainbow Dash",
        "Rarity's teacher",
        "Young Rarity",
        "Young Twilight Sparkle",
        "Crystal Clear",
        "Arpeggio",
        "Top Marks",
        "Cherry Fizzy",
        "Igneous Rock Pie",
        "Cloudy Quartz",
        "Young Pinkie Pie",
        "Cutie Mark Crusaders, Mane Six",
        "Owlowiscious",
        "Davenport",
        "Green dragon",
        "Gummy",
        "Pinkie Pie voicing a bucket of turnips",
        "Pinkie Pie voicing a pile of rocks",
        "Pinkie Pie voicing a clump of lint",
        "Pinkie Pie voicing a bag of flour",
        "Pinkie Pie [as Rocky]",
        "Rocky",
        "Sir Lintsalot",
        "Madame le Flour",
        "Mr Turnip",
        "Pinkie Pie [as Mr Turnip]",
        "Pinkie Pie [as Sir Lintsalot]",
        "Pinkie Pie [as Madame le Flour]",
        "Applejack, Fluttershy, Rarity, Twilight Sparkle",
        "Mane Six except Pinkie Pie",
        "Lucky Clover",
        "Prince Blueblood",
        "Mr Greenhooves",
        "Prince Blueblood, Rarity",
        "Joe",
        "Mane Six except Spike",
        "Discord",
        "Rarity, Twilight Sparkle",
        "Apples",
        "Red apples",
        "Light-red apples",
        "Green apples",
        "Pond Rainbow Dash",
        "Pond Fluttershy",
        "Pond Pinkie Pie",
        "Pond Rarity",
        "Pond Twilight Sparkle",
        "Discord, Green apples",
        "Balloons",
        "Butterflies",
        "Flashback Discord",
        "Applejack, Fluttershy, Pinkie Pie, Rarity",
        "Applejack, Fluttershy, Pinkie Pie",
        "Crowd",
        "Fillies",
        "Bear",
        "Apple Bloom, Scootaloo, Sweetie Belle",
        "Orange Swirl",
        "Applejack, Fluttershy, Pinkie Pie, Rainbow Dash, Rarity, Twilight Sparkle",
        "Pipsqueak",
        "Foals",
        "Background ponies",
        "Pinkie Pie, Pipsqueak",
        "Cloud Kicker",
        "Raven",
        "Several ponies",
        "Sassaflash",
        "Citizens",
        "Noi",
        "Princess Luna (as Nightmare Moon)",
        "Hondo Flanks",
        "Cookie Crumbles",
        "Apple Bloom, Applejack",
        "Sheep",
        "Apple Bloom, Applejack, Rarity",
        "Apple Bloom, Applejack, Sweetie Belle",
        "Rarity, Sweetie Belle",
        "Sea Swirl",
        "Scootaloo, Sweetie Belle",
        "Scootaloo, Sweetie Belle, Twist",
        "Apple Bloom, Applejack, Spike",
        "Daisy, Lily Valley, Rose",
        "Fan club",
        "Aura",
        "Millie",
        "Cream Puff",
        "Pony 1",
        "Pony 2",
        "Lemon Daze",
        "Globe Trotter",
        "Wisp",
        "Crafty Crate",
        "Jack Hammer",
        "Jim Beam",
        "Rivet",
        "Amethyst Star",
        "Pine Breeze",
        "Liza Doolots",
        "Mare Do Well",
        "Mane Six except Rainbow Dash",
        "Pinkie Pie, Spike",
        "Others",
        "Bags Valet",
        "Jet Set",
        "Upper Crust",
        "Hayseed Turnip Truck",
        "Jet Set, Upper Crust",
        "Fancy Pants",
        "Fleur de Lis",
        "Announcer",
        "Silver Frames",
        "Golden Gavel",
        "Swan Song",
        "Fancy Pants, Upper Crust",
        "Junebug",
        "Dr Horse",
        "Dr Fauna",
        "Fluttershy, Rainbow Dash",
        "Spike (flashback)",
        "Rarity (flashback)",
        "Rarity, Spike",
        "Pinkie Pie, Rainbow Dash, Rarity",
        "Pegasi",
        "Unicorns",
        "Applejack, Fluttershy, Twilight Sparkle",
        "Applejack, Fluttershy",
        "Apple Bloom, Applejack, Big McIntosh",
        "Filthy Rich",
        "Apple Strudel",
        "Foals except Apple Bloom",
        "Foals, Granny Smith",
        "Pound Cake",
        "Pumpkin Cake",
        "Pound Cake, Pumpkin Cake",
        "Derpy",
        "Conductor",
        "Assembled ponies",
        "Parcel Post",
        "Cherry Jubilee",
        "Coach ponies",
        "Rabbit",
        "Fluttershy, Rainbow Dash, Twilight Sparkle",
        "Flam",
        "Flim",
        "Flam, Flim",
        "Apple Bloom, Big McIntosh, Granny Smith",
        "Apple family, Mane Six",
        "Comet Tail",
        "Pinkie Pie, Rarity, Twilight Sparkle",
        "Doctor Horse",
        "Nurse Sweetheart",
        "Daring Do",
        "Ahuizotl [with Pinkie Pie's voice]",
        "Nurse Snowheart",
        "Ahuizotl",
        "Spider [with Fuzzy Slippers's voice]",
        "Fuzzy Slippers",
        "Screwy",
        "Night Watch",
        "Hay Fever",
        "Persnickety",
        "Big McIntosh, Cheerilee",
        "Karat",
        "Mr Waddle",
        "Matilda",
        "Cranky Doodle Donkey",
        "Cranky Doodle Donkey, Matilda",
        "Sand Trap",
        "Turf",
        "Surf",
        "Gizmo",
        "Roma",
        "Willful Lighting Tech",
        "Willful Stage Manager",
        "Iron Will",
        "Royal Riff",
        "Mr Zippy",
        "Fluttershy, Pinkie Pie, Rarity",
        "Future Twilight Sparkle",
        "Rainbow Dash, Spike",
        "Past Twilight Sparkle",
        "Applejack, Pinkie Pie, Rainbow Dash",
        "Rarity, Spike, Twilight Sparkle",
        "Fume",
        "Clump",
        "Garble",
        "Fizzle",
        "Teenage dragons",
        "Backdraft, Charcoal",
        "Backdraft",
        "Charcoal",
        "Crackle",
        "Rainbow Dash, Rarity, Spike, Twilight Sparkle",
        "Flitter",
        "Film announcer",
        "Thunderlane",
        "Bulk Biceps",
        "Filly Fluttershy",
        "Cloud Chaser",
        "Blossomforth",
        "Cloud Chaser, Flitter",
        "Rumble",
        "Serenity",
        "Slipstream",
        "Young Six",
        "Gallus",
        "Silverstream",
        "Smolder",
        "Yona",
        "Sandbar",
        "Ocellus",
        "Truffle",
        "Ruby Pinch",
        "Green Daze",
        "Cotton Cloudy",
        "Shady Daze",
        "Mr Cake, Mrs Cake",
        "Gustave le Grand",
        "Donut Joe",
        "Mulia Mild",
        "Shining Armor",
        "Young Cadance",
        "Young Cadance, Young Twilight",
        "Young Twilight",
        "Wild Fire",
        "Princess Cadance",
        "Minuette",
        "Lyra Heartstrings",
        "Royal guard",
        "Queen Chrysalis",
        "Princess Cadance, Twilight Sparkle",
        "Lyra Heartstrings, Minuette, Twinkleshine",
        "Changelings",
        "Applejack, Fluttershy, Pinkie Pie, Rainbow Dash, Twilight Sparkle",
        "Changelings [as Twilight Sparkle]",
        "Changelings [as Rainbow Dash]",
        "Changeling",
        "Changelings, Queen Chrysalis",
        "Princess Cadance, Shining Armor",
        "Royal guard #1",
        "Royal guard #2",
        "King Sombra",
        "Professor Bill Neigh",
        "Other ponies",
        "Autumn Gem",
        "Fleur De Verre",
        "Elbow Grease",
        "Night Knight",
        "Amethyst Maresbury",
        "Crystal Ponies",
        "Autumn Gem, Fleur De Verre",
        "Crystal Pony",
        "Crystal Beau",
        "Sapphire Joy",
        "Bright Smile",
        "Pinkie Pie 2",
        "Pinkie Pie, Pinkie Pie 2",
        "Pinkie Pie 3",
        "Pinkie Pie 2, Pinkie Pie 3, Pinkie Pie 4",
        "Pinkie Pie 4",
        "Pinkie Pie Duplicates",
        "Pinkie Pie Duplicate",
        "Apple Fritter, Applejack, Big McIntosh, Meadow Song",
        "Apple Fritter",
        "Pinkie Pie Duplicate 2",
        "Pinkie Pie Duplicate 3",
        "Pinkie Pie Duplicate 4",
        "Pinkie Pie Duplicate 5",
        "Pinkie Pie Duplicate 6",
        "Babs Seed",
        "Babs Seed, Diamond Tiara, Silver Spoon",
        "Spectator",
        "Shopkeeper",
        "Rainbow Dash, Snails",
        "Mane Six except Trixie",
        "Baby Snips",
        "Old Snails",
        "Other ponies, Spike",
        "Baby Snails, Baby Snips",
        "Baby Snails",
        "Big McIntosh (as Male Applejack)",
        "Saddle Arabian delegates",
        "Bessie",
        "The Olden Pony",
        "Crocodile",
        "Messenger Pony",
        "All Pegasi",
        "Lightning Dust",
        "Cloudchaser",
        "Meadow Flower",
        "Lightning Dust, Rainbow Dash",
        "Applejack, Fluttershy, Rarity",
        "Fluttershy, Rarity, Twilight",
        "Applejack, Fluttershy, Rarity, Twilight",
        "Young Granny Smith",
        "Half Baked Apple",
        "Apple Split",
        "Baby Applejack",
        "Young Apple Rose",
        "Young Apple Rose, Young Granny Smith",
        "Apple Bloom, Granny Smith",
        "Apple Bloom, Babs Seed",
        "Auntie Applesauce",
        "Apple Rose",
        "Apple Rose, Granny Smith",
        "Apple Dumpling",
        "Apple Leaves",
        "Stallions",
        "Apple Rose, Auntie Applesauce, Granny Smith",
        "Applejack, Granny Smith",
        "Fluttershy, Rainbow Dash, Rarity, Twilight Sparkle",
        "Applejack, Pinkie Pie, Rarity, Spike, Twilight Sparkle",
        "Pinkie Pie, Rarity, Spike, Twilight Sparkle",
        "Tank",
        "Opalesence",
        "Laurette",
        "Train Conductor",
        "Princess Cadance, Twilight",
        "Golden Hooves",
        "Ms. Peachbottom",
        "Ms. Harshwhinny",
        "Athletes",
        "Shining Armor, Twilight Sparkle",
        "Royal guard #3",
        "Royal Guard",
        "Cragadile",
        "Cherry Berry, Comet Tail",
        "Plant Crab",
        "Ahuizotl [with Fluttershy's voice]",
        "A.K. Yearling",
        "Henchponies",
        "Dr Caballeron",
        "Train conductor",
        "Cutie Mark Crusaders, Rainbow Dash",
        "Mane-iac",
        "Henchpony",
        "Luggage Cart",
        "Tourist Pony 1",
        "Businesspony",
        "Pronto",
        "Janine Manewitz",
        "Prim Hemline",
        "Suri Polomare",
        "Coco Pommel",
        "Mane Six except Twilight Sparkle except Rarity",
        "Hinny of the Hills",
        "Applejack, Pinkie Pie",
        "Big McIntosh, Granny Smith",
        "Everypony",
        "Goldie Delicious",
        "Bulk Biceps, Fluttershy",
        "Helia",
        "Mane Moon",
        "Sprinkle Medley",
        "Fleetfoot",
        "Cloudsdale cheerleaders",
        "Rainbowshine, Sprinkle Medley",
        "Fleetfoot, Spitfire",
        "Ponyville team, Wonderbolts",
        "Ponyville team",
        "Wonderbolts",
        "Bulk Biceps, Derpy, Fluttershy",
        "Derpy, Mane Six except Rainbow Dash",
        "Official",
        "Tatzlwurm",
        "Cheese Sandwich",
        "Vendor Pony",
        "Art Vendor",
        "Peachy Pitt",
        "Colt",
        "Cheese Sandwich, Pinkie Pie",
        "Trenderhoof",
        "Animals",
        "Torch Song",
        "The Ponytones",
        "Nightjar",
        "Zipporwhill",
        "Nightjar, Zipporwhill",
        "Mane Six except Fluttershy or Rarity",
        "Seedling",
        "Classmate Pony 2",
        "Classmate Pony 3",
        "Seabreeze",
        "Breezies",
        "Twirly",
        "Breezie",
        "Breezette",
        "Applejack, Big McIntosh, Granny Smith",
        "Apple Bloom, Applejack, Granny Smith",
        "Chimera's tiger head",
        "Chimera's goat head",
        "Chimera's snake head",
        "Chimera",
        "Chimera's goat head, Chimera's tiger head",
        "Duce Switchell",
        "Maud Pie",
        "Sediments",
        "Eclair Cr√®me",
        "Star Gazer",
        "Mint Flower",
        "Little Pony 2",
        "Plum Star",
        "Younger Sweetie Belle",
        "Titania",
        "Backup dancers",
        "Backup dancers, Sapphire Shores",
        "Security guard",
        "Applejack, Big McIntosh",
        "Silver Shill",
        "Jinx",
        "Snappy Scoop",
        "Big McIntosh, Rainbow Dash",
        "Pegasus Stallion #1",
        "Downdraft",
        "Pegasus Stallion #2",
        "High Note",
        "Crowd Pony 1",
        "Crowd Pony 2",
        "Teddie Safari",
        "Cratus",
        "Stellar Eclipse",
        "Match Game",
        "Amethyst Gleam",
        "Crowd Pony 3",
        "Constance",
        "Claude",
        "Mr Robin",
        "Stallion",
        "Crystal Guard",
        "Applejack, Rainbow Dash, Rarity, Twilight Sparkle",
        "Neighls Bohr",
        "Security Guard",
        "Crystal Pony in Crowd",
        "Princess Celestia, Princess Luna",
        "Security Guard 2",
        "Mane Six except Spike, Princess Cadance, Princess Celestia, Princess Luna",
        "Flash Sentry",
        "Duke of Maretonia",
        "Lord Tirek",
        "Rare Find",
        "Princess Cadance, Princess Luna, Twilight Sparkle",
        "Sunny Song",
        "Town pony #1",
        "Town pony #2",
        "Bacon Braids",
        "Town pony #3",
        "Offbeat",
        "Cotton Cloudy, Princess Erroria, Ruby Pinch, Town pony #4",
        "Princess Erroria",
        "Town pony #4",
        "Night Glider",
        "Party Favor",
        "Double Diamond",
        "Starlight Glimmer",
        "Ivy Vine",
        "Burlap",
        "Sugar Belle",
        "Rosemary",
        "Rocky Storm",
        "Aloe",
        "Rainbow Dash, Rarity",
        "Mane Six except Applejack except Twilight",
        "Pest Control Pony",
        "Mysterious Voice",
        "Sunshower",
        "Open Skies",
        "Clear Skies",
        "Clear Skies, Open Skies",
        "Parasol",
        "Fluttershy, Pinkie Pie, Rainbow Dash, Rarity",
        "Townspony 1",
        "Townspony 2",
        "Townspony 3",
        "Townspony 4",
        "Star Spur",
        "Senior Deputy",
        "Trouble Shoes",
        "Young Trouble Shoes",
        "Judges",
        "Female Townspony #1",
        "Male Townspony #1",
        "Female Townspony #2",
        "Judge",
        "Tree Hugger",
        "The Smooze",
        "Apple Bloom, Applejack, Fluttershy, Rainbow Dash, Scootaloo, Tree Hugger",
        "S01E26 Unnamed Earth Mare #1",
        "Grampa Gruff",
        "Arimaspi",
        "Storekeeper",
        "Greta",
        "Young Gilda",
        "Young Gilda, Young Rainbow Dash",
        "Gilda, Pinkie Pie, Rainbow Dash",
        "Jeff Letrotski",
        "Octavia Melody",
        "Walter",
        "Neigh Sayer",
        "Delegate 2",
        "Polo ponies",
        "Horticultural Pegasus",
        "Public Works Pony",
        "Joe Pescolt, March Gustysnows",
        "Joe Pescolt",
        "March Gustysnows",
        "Annoyed Delegate",
        "Fluffy Clouds",
        "Frazzle Rock",
        "Princess Cadance, Spike",
        "Prince Rutherford",
        "Prince Rutherford, Yaks",
        "Yaks",
        "Mane Six except Pinkie",
        "Monster",
        "Mane Six, Princess Celestia, Yaks",
        "Lemon Hearts, Minuette, Twilight Sparkle, Twinkleshine",
        "Lemon Hearts, Minuette, Twinkleshine",
        "Minuette, Twinkleshine",
        "Young Moon Dancer",
        "Moon Dancer",
        "Lemon Hearts, Twinkleshine",
        "Minuette, Spike, Twilight Sparkle, Twinkleshine",
        "Lemon Hearts, Minuette, Moon Dancer, Twinkleshine",
        "Giant Evil Angel",
        "Sunflowers",
        "Sassy Saddles",
        "Fashion Plate",
        "Fashion Plate, Rarity",
        "Mane Six except Rarity, Twilight",
        "Cayenne",
        "Pretzel",
        "Moonlight Raven",
        "Sunshine Smiles",
        "North Point",
        "Citrus Blush",
        "Whoa Nelly",
        "Rarity, Sassy Saddles",
        "Package Deal",
        "Wind Rider",
        "Stormy Flare",
        "Blaze",
        "Castle Guard 1",
        "Spearhead",
        "Cinnamon Chai",
        "Diamond Cutter",
        "Strawberry Ice",
        "Pedestrian Ponies 3 & 4",
        "Pearmain Worcester",
        "Stinky Bottom",
        "Street Pony",
        "Fine Print",
        "Chock-full Carafe",
        "Uptown Clover",
        "On Stage",
        "Raspberry Beret",
        "Late Show",
        "Cloudy Daze",
        "Blueberry Curls",
        "Stardom",
        "Luckette",
        "Pearly Stitch",
        "Viola",
        "Booth Barker",
        "Apple Bloom, Big McIntosh",
        "Rainbow Dash, Scootaloo",
        "Registration Pony",
        "Spoiled Rich",
        "Cheerilee, Foals",
        "Mrs Cake, Pumpkin Cake",
        "Featherweight",
        "Wooden Legs",
        "Mane Six except Pinkie Pie, Shining Armor",
        "Porter Pony",
        "Igneous Rock",
        "Limestone Pie",
        "Marble Pie",
        "Pie family",
        "Apple family, Pie family",
        "Harry",
        "Amethyst Star, Twinkleshine",
        "Mane Six except Fluttershy, Pinkie Pie",
        "Flutterbat",
        "Discord, Rainbow Dash",
        "Discord, Fluttershy, Rarity",
        "Discord, Mane Six except Twilight Sparkle",
        "Discord, Mane Six",
        "Ma Hooffield",
        "Buzzard Hooffield",
        "Mice",
        "Steel Bolts",
        "Rosy Riveter",
        "Big Daddy McColt",
        "McColts",
        "McColt Guards",
        "Hacksaw McColt",
        "Hooffields",
        "Big Daddy McColt, Ma Hooffield",
        "Lyra Heartstrings, Sweetie Drops",
        "Fluttershy, Noteworthy, Rainbow Dash, Rarity, Royal Riff, Spike, Sprinkle Medley, Twilight Sparkle",
        "Fluttershy, Pinkie Pie, Rainbow Dash, Rarity, Royal Riff, Spike, Sprinkle Medley, Twilight Sparkle",
        "Svengallop",
        "Coloratura",
        "Audience Pony",
        "Hoops, Young Dumb-Bell",
        "Fluttershy, Hoops, Young Dumb-Bell",
        "Starlight Glimmer, Twilight Sparkle",
        "Sunburst",
        "Scarlet Heart",
        "Amber Laurel",
        "Golden V√§s",
        "Flurry Heart",
        "Cloudy Spinel",
        "Coral Shores",
        "Tough Nut",
        "Scouts Honor",
        "Mustafa Combe",
        "Spike, Starlight Glimmer",
        "Night Light",
        "Twilight Velvet",
        "Deputy Copper",
        "Street Rat",
        "Hoofer Steps",
        "Tender Taps",
        "Dragon Lord Torch",
        "Dragons",
        "Princess Ember",
        "Maar",
        "Barry",
        "Cherry Berry, Goldengrape",
        "Caramel, Shoeshine, Sunshower Raindrops",
        "Sunshower Raindrops",
        "Starlight Glimmer, Trixie",
        "Rainbow Dash, Spitfire",
        "Young Hoops, Young Pegasi",
        "Young Pegasi",
        "Fleetfoot, High Winds, Misty Fly, Soarin, Surprise",
        "High Winds",
        "Surprise",
        "Rainbow Dash, Surprise",
        "Cutie Mark Crusaders, Mane Six except Rainbow Dash",
        "Professor Flintheart",
        "Young Starlight Glimmer",
        "Buried Lede",
        "Mr Stripes",
        "Plaid Stripes",
        "Rarity Devil",
        "Rarity Angel",
        "Dancers",
        "Blue Bobbin",
        "Waxton",
        "Lavender Essence",
        "Buddy",
        "Birch Bucket",
        "Mrs Shy",
        "Mr Shy",
        "Zephyr Breeze",
        "Saffron Masala",
        "Coriander Cumin",
        "Chargrill Breadwinner",
        "Orange Slice",
        "Pinkie Pie, Saffron Masala",
        "Zesty Gourmand",
        "Coriander Cumin, Pinkie Pie, Rarity",
        "Coriander Cumin, Saffron Masala",
        "Coriander Cumin, Pinkie Pie",
        "Sweet Biscuit",
        "Burly Unicorn",
        "Matronly Pony",
        "Salespony",
        "Quibble Pants, Rainbow Dash",
        "Quibble Pants",
        "A. K. Yearling",
        "Pickpocket",
        "Cipactli",
        "Dr Caballeron, Henchponies",
        "Upper class ponies",
        "Mrs Cake, Pinkie Pie",
        "Lyra Heartstrings, Twinkleshine",
        "Zombie ponies",
        "Honeysparkle",
        "Royal guard 1",
        "Royal guard 2",
        "Thorax",
        "Baby Thorax",
        "Spike, Thorax",
        "Royal guards, Shining Armor",
        "Princess Cadance, Sunburst",
        "Opposite Fluttershy",
        "Mini-Discord",
        "Big McIntosh, Spike",
        "Squizard",
        "Big McIntosh, Discord, Spike",
        "Discord, Spike",
        "Crimson Heart",
        "Aloha",
        "Fluttershy, Pinkie Pie",
        "Applejack, Fluttershy, Pinkie Pie, Rainbow Dash, Snails",
        "Mrs Paleo",
        "Mr Paleo",
        "Petunia Paleo",
        "Mr Paleo, Mrs Paleo",
        "Gabby",
        "Elderly griffon",
        "Barker",
        "Gladmane",
        "Trapeze Star",
        "Director",
        "Roar Horn",
        "Sprigfield",
        "Bernard Rabbit",
        "Back Stage",
        "Roar Horn, Sprigfield",
        "Young Big McIntosh",
        "Young Applejack, Young Big McIntosh",
        "Spoiled Milk",
        "Granny Smith, Young Applejack",
        "Granny Smith, Young Big McIntosh",
        "Hippocratic Oath",
        "Doctor Spring Bud",
        "Open Heart",
        "Angel Wings",
        "Sky Stinger",
        "Recruits except Sky Stinger",
        "Vapor Trail",
        "Recruits",
        "Twirly Whirly",
        "Steer Straight",
        "Young Vapor Trail",
        "Young Sky Stinger",
        "Double Diamond, Party Favor",
        "Village ponies",
        "Princess Luna, Starlight Glimmer",
        "Changeling Twilight",
        "Pigasus",
        "Thorax, Trixie",
        "Fluttershys",
        "Fluttershy #1",
        "Fluttershy #2",
        "Fluttershy #3",
        "Fluttershy #4",
        "Starlight Glimmer, Thorax",
        "Changeling Girl",
        "Changeling 1",
        "Goofy Changeling",
        "Cornicle",
        "Princess Ember, Starlight Glimmer",
        "Sunburst, Twilight Sparkle",
        "Ginger Locks",
        "Clarity Cut",
        "Cake Twins, Flurry Heart",
        "Cake Twins",
        "Foals, Nurse Redheart",
        "Flurry Heart, Twilight Sparkle",
        "Peach Fuzz",
        "Rusty Tenure",
        "Clementine",
        "Dr Fauna, Fluttershy",
        "Rupert",
        "Dandy Grandeur",
        "Wrangler",
        "Hard Hat",
        "Dandy Grandeur, Hard Hat, Wrangler",
        "Jack Hammer, Steam Roller",
        "Starry Eyes",
        "Chipcutter",
        "Ripley",
        "Apple Bloom, Scootaloo, Zipporwhill",
        "Bow Hothoof",
        "Windy Whistles",
        "Bow Hothoof, Windy Whistles",
        "Bow Hothoof, Rainbow Dash, Windy Whistles",
        "Feather Bangs",
        "Swooning Ponies",
        "Swoon Song",
        "Fond Feather",
        "Big McIntosh, Sugar Belle",
        "Inky Rose, Lily Lace, Starstreak",
        "Inky Rose",
        "Lily Lace",
        "Starstreak",
        "Hoity Toity, Photo Finish",
        "Hoity Toity, Lily Lace, Rarity",
        "All except Applejack",
        "Strawberry Sunrise",
        "Hard Hat, Jack Hammer, Rivet, Steam Roller",
        "Delegate Ponies",
        "Mayor Cream Cheese",
        "Mayor Baltimare",
        "Mayor Baltimare, Mayor Cream Cheese",
        "Pancakes",
        "Daybreaker",
        "Princess Celestia, Starlight Glimmer",
        "Dream Ponies",
        "Dream Pony",
        "Pinkie Pie, Prince Rutherford, Yaks",
        "Pinkie Pie, Yaks",
        "Yak Kid 1",
        "Yak Kid 2",
        "Prince Rutherford, Yak",
        "Yak",
        "Discord, Fluttershy",
        "Discord's finger",
        "Discord 2",
        "Jasmine Leaf",
        "Raspberry Vinaigrette",
        "Pi√±ata",
        "Discord 3",
        "Other Discords",
        "All Discords",
        "Grand Pear",
        "Young Grand Pear",
        "Young Bright Macintosh",
        "Young Pear Butter",
        "Burnt Oak",
        "Bright Mac",
        "Pear Butter",
        "Bright Mac, Pear Butter",
        "Chiffon Swirl",
        "Young Mayor Mare",
        "Grand Pear, Granny Smith",
        "Toola Roola",
        "Coconut Cream",
        "Coconut Cream, Toola Roola",
        "Out of Town Pony",
        "Out of Town Pony 2",
        "Lavender Bloom",
        "Pegasus Fillies",
        "Glasses Stallion",
        "Lemon Chiffon",
        "Sweet Apple Admirer",
        "Reporter Pony",
        "Ember",
        "Crusoe Palm",
        "Rainbow Stars",
        "Crusoe Palm, Rainbow Stars",
        "Ember, Thorax",
        "Spike, Starlight Glimmer, Twilight Sparkle",
        "Ember, Spike, Thorax",
        "Mighty Helm ponies",
        "Rockhoof",
        "Rainbow Dash, Scootaloo, Sweetie Belle",
        "All except Rainbow Dash",
        "All except Sweetie Belle",
        "Mistmane",
        "Villager",
        "Foal",
        "Sable Spirit",
        "Flash Magnus",
        "Commander Ironhead",
        "Pharynx",
        "Sclerite",
        "Frenulum",
        "Green Changeling",
        "Tymbal",
        "Changeling 2",
        "Changeling 3",
        "All changelings",
        "Pharnyx",
        "Young Changeling",
        "Young Pharynx",
        "Young Thorax",
        "Passing Changeling",
        "Newspaper Pony",
        "Cortland",
        "Mrs Trotsworth",
        "Random Villager",
        "Nile Faras",
        "Mr Breezy",
        "Chelsea Porcelain",
        "Creature",
        "Customer Pony",
        "Silver Medal",
        "Mane Six except Rarity, Starlight Glimmer",
        "Daisy, Lily Valley",
        "Cattail",
        "Fluttershy, Mage Meadowbrook",
        "Mage Meadowbrook",
        "Chipmunk",
        "Meadowbrook's Mother",
        "Royal Pin",
        "Kettle Corn",
        "Skeedaddle",
        "Sparkle family",
        "Sparkle family except Twilight Sparkle",
        "Night Light, Twilight Velvet",
        "Raspberry Sorbet",
        "Cruise Ponies",
        "Sunny Side",
        "Star Tracker",
        "Sun Cloche",
        "Cruise ponies",
        "Fan",
        "Flurry Heart, Princess Cadance",
        "Everypony else",
        "Cruise pony",
        "Janitor Pony",
        "Fleetfoot, Soarin, Spitfire",
        "EMT Pony",
        "All Aboard",
        "Young Sunburst",
        "All except Maud Pie",
        "Star Swirl the Bearded",
        "Pony of Shadows",
        "Professor Fossil",
        "Lotus Petal",
        "Billy",
        "Dragon",
        "Fahal Alkhayl",
        "Somnambula",
        "Sirens",
        "Aria Blaze",
        "Stygian",
        "Neighsay",
        "Seaspray",
        "Gallus, Yona",
        "Ocellus, Silverstream, Yona",
        "Silverstream, Smolder",
        "Ember, Grampa Gruff, Prince Rutherford, Seaspray, Thorax",
        "Sandbar, Smolder",
        "Young Six except Silverstream",
        "Mudbriar",
        "Fluttershy's apparition",
        "Rarity's apparition",
        "Applejack's apparition",
        "Rainbow Dash's apparition",
        "Twilight Sparkle's apparition",
        "Mane five's apparitions",
        "Background pony 1",
        "Background pony 2",
        "Background pony 3",
        "Background pony 4",
        "Pursey Pink",
        "Pursey Pink, Rarity",
        "Bracer Britches",
        "Silver Berry",
        "Old Money",
        "Valley Trend",
        "Snow Hope",
        "Joan Pommelway",
        "Mare E. Lynn",
        "Applejack, Pinkie Pie, Rainbow Dash, Spike, Twilight Sparkle",
        "Applejack, Pinkie Pie, Rainbow Dash, Twilight Sparkle",
        "Grannies",
        "Applejack vision",
        "Cranberry Muffin",
        "Tight End",
        "Carnival Barker",
        "Jack Pot",
        "Big Bucks",
        "Terramar",
        "Sky Beak",
        "Cutie Mark Crusaders, Twilight Sparkle",
        "Ocean Flow",
        "Applejack, Fluttershy, Rainbow Dash, Rarity, Starlight Glimmer",
        "All except Pinkie Pie",
        "All except Twilight Sparkle",
        "Mail Pony",
        "Starlight Glimmer, Sunburst, Twilight Sparkle",
        "Automated voice",
        "Ever Essence",
        "Raspberry Latte",
        "Minty Mocha",
        "Firelight",
        "Stellar Flare",
        "Firelight, Stellar Flare",
        "Starlight Glimmer, Sunburst",
        "Cracked Wheat",
        "Ever Essence, Minty Mocha, Raspberry Latte",
        "Young Six except Sandbar",
        "Gallus, Smolder",
        "Peewee",
        "Tourist Pony",
        "Citrine Spark",
        "Berry Bliss",
        "Cozy Glow",
        "Apple Bloom, Cozy Glow",
        "Cozy Glow, Cutie Mark Crusaders",
        "Photographer",
        "Mean Pinkie Pie",
        "Mean Fluttershy",
        "Mean Rarity",
        "Mean Applejack",
        "Mean Rainbow Dash",
        "Mean Twilight Sparkle",
        "Bird 1",
        "Bird 2",
        "Applejack, Rainbow Dash, Rarity, Starlight Glimmer",
        "Mean Applejack, Mean Pinkie Pie, Mean Rarity",
        "Rarity, Starlight Glimmer",
        "Mane Six except Twilight Sparkle or Fluttershy",
        "Mean Ponies",
        "Mean Fluttershy, Mean Rarity",
        "Applejack, Starlight Glimmer",
        "Voice on bananaphone",
        "Ocellus, Smolder",
        "King Grover Painting",
        "Gallus, Silverstream",
        "Changeling Painting",
        "Pony Painting",
        "Discord's Ghost",
        "Rainbow Dash, Spike, Twilight Sparkle",
        "Young Six except Yona",
        "Young Six except Gallus",
        "Polo Play",
        "Chancellor Neighsay",
        "Destitute Pony",
        "Student 4",
        "Cherry Fizzy, Lyra Heartstrings, Rose, Savoir Fare, Sweetie Drops",
        "Bufogren",
        "Yak waiter",
        "Yigrid",
        "Hoo'Far",
        "Tall Pony",
        "Short Pony",
        "Round Pony",
        "Rainy Day",
        "Snow Violet",
        "Rainy Day, Snow Violet",
        "Announcer, Crowd",
        "Fanpony",
        "Rolling Thunder, Short Fuse",
        "Rolling Thunder",
        "Short Fuse",
        "Gallus, Silverstream, Yona",
        "Hippogriff Sailor",
        "Ocellus, Sandbar",
        "Young Six except Smolder",
        "Young Six except Ocellus",
        "Illusion Twilight Sparkle",
        "Stepford Pony 1",
        "Stepford Pony 2",
        "Illusion Rarity",
        "Illusion Rainbow Dash",
        "Spindle",
        "Tree of Harmony",
        "Silverstream, Yona",
        "Loose Tracks",
        "Autumn Blaze",
        "Rain Shine",
        "Sludge",
        "Mane Six, Spike",
        "Sludge, Spike",
        "Special Delivery",
        "Patty Peppermint",
        "Cerberus",
        "Cutie Mark Crusaders, Sandbar",
        "Chancellor Neighsay, Twilight Sparkle",
        "All except Cutie Mark Crusaders",
        "Grogar",
        "Lord Tirek, Queen Chrysalis",
        "Mane Six except Twilight Sparkle, Starlight Glimmer",
        "Mane Six except Twilight Sparkle, Spike",
        "Star Swirl",
        "Mane Six, Princess Celestia, Princess Luna",
        "Cozy Glow, Lord Tirek, Queen Chrysalis",
        "Tourists",
        "Server Pony",
        "Saturn",
        "BeauDe Mane",
        "Dusty Pages",
        "Librarian Pony",
        "First Folio",
        "Meathead Pony",
        "Old Stallion",
        "Dusty Pages, Spike",
        "Male Pony",
        "Clear Sky",
        "Wind Sprint",
        "Game Announcer",
        "Referee",
        "Clear Sky, Quibble Pants, Wind Sprint",
        "Gallus, Ocellus, Smolder",
        "Gallus, Ocellus, Silverstream, Smolder",
        "Sandbar, Yona",
        "Rusty Bucket",
        "Cozy Glow, Lord Tirek",
        "Cozy Glow, Queen Chrysalis",
        "Fluttershy, Smolder, Spike",
        "Dragons, Garble",
        "Billy, Clump, Fume",
        "Goldie Delicious, Granny Smith",
        "Student Pony",
        "Sunburst, Trixie",
        "Sunburst, Terramar, Trixie",
        "Edith",
        "Aunt Holiday",
        "Auntie Lofty",
        "Snap Shutter",
        "Mane Allgood",
        "Mr Tortoise-Snap",
        "Guard Pony 1",
        "Guard Pony 2",
        "Sans Smirk",
        "Factory Pony",
        "Lighthoof, Shimmy Shake",
        "Lighthoof",
        "Shimmy Shake",
        "Cheer Squad",
        "Pizzelle",
        "November Rain",
        "Ocellus, Yona",
        "School of Friendship Team",
        "Apple Honey",
        "Apple Cobbler",
        "Feather Flatterfly",
        "Fire Flare",
        "Unicorn 1",
        "Antoine",
        "Muriel",
        "Sandra",
        "Scout",
        "Gabby, Spike",
        "Pinkie Pie, Rarity, Spike",
        "All except Starlight Glimmer",
        "Dad Changeling",
        "Yona's Parents",
        "Groom Q. Q. Martingale",
        "Rogue",
        "Dr Caballeron, Fluttershy, Henchponies",
        "Withers",
        "Biff",
        "Daring Do, Dr Caballeron",
        "Spur",
        "Biscuit",
        "Savage Honeydew, Spring Green",
        "Savage Honeydew",
        "Spring Green",
        "Bloofy",
        "Passerby Pony",
        "Talking Apple",
        "Talking Apple 2",
        "Talking Apple 3",
        "Cutie Mark Crusaders, Granny Smith",
        "Giant Apple",
        "Large Apple",
        "Unicorn Baker",
        "Fruit Seller",
        "Pillars",
        "Queen Chrysalis, Starlight Glimmer",
        "Royal Guards",
        "Princess Celestia, Princess Luna, Twilight Sparkle",
        "Winter Lotus",
        "S08E14 Unnamed Earth Mare #4",
        "Earth Pony 2",
        "Cotton Sky",
        "Hyper Sonic",
        "Rasberry[sic] Dazzle",
        "Future Spike",
        "Future Gallus",
        "Luster Dawn",
        "Baker Pony",
        "Future Pinkie Pie",
        "Future Rarity",
        "Future Rainbow Dash",
        "Future Applejack",
        "Future Fluttershy",
        "Future Mane Six, Spike",
        "Future Mane Six",
        "Mane Six, Spike, Starlight Glimmer"
    ]
    const speakerGroups = {
        "2": [
            1,
            3
        ],
        "12": [
            3,
            7,
            8,
            12,
            13,
            14
        ],
        "13": [
            14,
            12,
            13
        ],
        "18": [
            8,
            14,
            7,
            12,
            13
        ],
        "30": [
            7,
            12
        ],
        "32": [
            49,
            12
        ],
        "39": [
            53,
            54
        ],
        "41": [
            8,
            7,
            13
        ],
        "43": [
            8,
            13
        ],
        "44": [
            8,
            13,
            69
        ],
        "46": [
            8,
            14,
            12
        ],
        "48": [
            8,
            7,
            12,
            13
        ],
        "49": [
            5,
            3
        ],
        "50": [
            12,
            13,
            3
        ],
        "51": [
            78,
            5
        ],
        "53": [
            8,
            14,
            12,
            13
        ],
        "54": [
            7,
            3
        ],
        "58": [
            8,
            5
        ],
        "60": [
            92,
            95
        ],
        "71": [
            111,
            112,
            114
        ],
        "73": [
            8,
            7,
            13,
            3
        ],
        "80": [
            10,
            102,
            101
        ],
        "81": [
            10,
            102
        ],
        "83": [
            128,
            14
        ],
        "84": [
            14,
            3
        ],
        "86": [
            135,
            136
        ],
        "91": [
            139,
            141
        ],
        "99": [
            14,
            7,
            12
        ],
        "101": [
            10,
            8,
            13
        ],
        "102": [
            10,
            8,
            102
        ],
        "103": [
            13,
            102
        ],
        "105": [
            101,
            102
        ],
        "106": [
            101,
            102,
            93
        ],
        "107": [
            10,
            8,
            5
        ],
        "108": [
            34,
            46,
            47
        ],
        "121": [
            286,
            287
        ],
        "128": [
            290,
            287
        ],
        "130": [
            7,
            12,
            13
        ],
        "133": [
            8,
            14,
            3
        ],
        "134": [
            8,
            14
        ],
        "135": [
            10,
            8,
            38
        ],
        "139": [
            243,
            9
        ],
        "144": [
            14,
            12,
            3
        ],
        "147": [
            325,
            326
        ],
        "148": [
            10,
            38,
            9
        ],
        "149": [
            11,
            18
        ],
        "158": [
            38,
            91
        ],
        "168": [
            14,
            7,
            13
        ],
        "173": [
            372,
            373
        ],
        "177": [
            12,
            13,
            5,
            3
        ],
        "183": [
            388,
            389,
            390,
            391,
            392,
            393
        ],
        "195": [
            404,
            406
        ],
        "204": [
            128,
            12
        ],
        "211": [
            8,
            7
        ],
        "212": [
            38,
            9
        ],
        "215": [
            379,
            14
        ],
        "220": [
            379,
            317,
            14
        ],
        "221": [
            317,
            282
        ],
        "229": [
            548,
            7
        ],
        "230": [
            558,
            559
        ],
        "240": [
            573,
            572
        ],
        "252": [
            38,
            12
        ],
        "264": [
            8,
            12,
            13,
            3
        ],
        "268": [
            25,
            26
        ],
        "276": [
            397,
            631,
            395,
            632
        ],
        "283": [
            12,
            13
        ],
        "300": [
            219,
            18
        ],
        "312": [
            112,
            181
        ],
        "313": [
            14,
            112,
            181
        ],
        "314": [
            636,
            3
        ],
        "330": [
            182,
            817
        ],
        "332": [
            537,
            819,
            122,
            123,
            820
        ],
        "335": [
            12,
            820
        ],
        "336": [
            128,
            282
        ],
        "354": [
            853,
            12
        ],
        "359": [
            514,
            513
        ],
        "363": [
            5,
            865
        ],
        "364": [
            6,
            403
        ],
        "365": [
            408,
            789
        ],
        "368": [
            38,
            5
        ],
        "373": [
            881,
            880
        ],
        "380": [
            175,
            895
        ],
        "382": [
            9,
            175
        ],
        "383": [
            9,
            895
        ],
        "390": [
            635,
            634
        ],
        "392": [
            26,
            636
        ],
        "395": [
            865,
            55
        ],
        "420": [
            34,
            46
        ],
        "422": [
            14,
            1059
        ],
        "429": [
            800,
            801
        ],
        "433": [
            793,
            408
        ],
        "437": [
            537,
            123,
            124
        ],
        "449": [
            388,
            391
        ],
        "463": [
            8,
            7,
            12,
            5,
            3
        ],
        "464": [
            8,
            7,
            12,
            3
        ],
        "470": [
            8,
            14,
            12,
            13,
            636
        ],
        "474": [
            636,
            789,
            3
        ],
        "480": [
            388,
            390
        ],
        "486": [
            10,
            1157
        ],
        "487": [
            1157,
            128
        ],
        "491": [
            8,
            12,
            13,
            636
        ],
        "492": [
            1164,
            1161,
            1163
        ],
        "493": [
            13,
            636
        ],
        "496": [
            1162,
            1163
        ],
        "497": [
            8,
            636
        ],
        "499": [
            393,
            390
        ],
        "503": [
            393,
            391
        ],
        "515": [
            514,
            14,
            513
        ],
        "518": [
            334,
            514
        ],
        "523": [
            128,
            9
        ],
        "529": [
            412,
            636
        ],
        "1b": [
            12,
            3
        ],
        "1c": [
            8,
            3
        ],
        "1d": [
            8,
            12
        ],
        "1e": [
            7,
            13
        ],
        "3c": [
            53,
            54,
            55
        ],
        "3e": [
            8,
            12,
            13
        ],
        "3f": [
            53,
            54,
            5
        ],
        "4a": [
            14,
            7,
            13,
            3
        ],
        "4b": [
            10,
            71
        ],
        "4d": [],
        "6b": [
            8,
            12,
            3
        ],
        "6d": [
            8,
            14,
            7,
            12
        ],
        "7d": [
            8,
            7,
            3
        ],
        "7e": [
            14,
            13
        ],
        "7f": [
            10,
            101
        ],
        "9a": [
            14,
            7,
            12,
            3
        ],
        "a5": [
            14,
            12,
            13,
            5,
            3
        ],
        "c2": [
            128,
            18
        ],
        "d3": [
            8,
            14,
            13,
            3
        ],
        "d8": [
            214,
            13
        ],
        "dc": [
            13,
            3
        ],
        "e6": [
            219,
            224
        ],
        "ea": [
            8,
            14,
            7,
            13
        ],
        "eb": [
            8,
            14,
            7
        ],
        "ef": [
            10,
            101,
            102
        ],
        "f1": [
            8,
            14,
            7,
            12,
            13,
            3
        ],
        "f3": [],
        "f5": [
            7,
            242
        ],
        "ff": [
            10,
            8
        ],
        "11b": [
            7,
            5
        ],
        "12c": [
            14,
            12
        ],
        "12f": [
            13,
            5
        ],
        "13c": [
            314,
            315
        ],
        "14b": [
            7,
            13,
            3
        ],
        "15d": [
            348,
            347
        ],
        "16a": [
            12,
            5
        ],
        "16c": [
            8,
            7,
            12
        ],
        "16d": [
            13,
            5,
            3
        ],
        "17f": [
            381,
            376
        ],
        "18f": [
            43,
            42
        ],
        "19d": [
            408,
            3
        ],
        "19e": [
            410,
            409,
            4
        ],
        "1a0": [
            8,
            14,
            7,
            12,
            3
        ],
        "1a4": [
            415,
            412
        ],
        "1a5": [
            408,
            403
        ],
        "1b1": [
            427,
            428
        ],
        "1b7": [
            7,
            438
        ],
        "1b9": [
            438,
            440,
            442
        ],
        "1bd": [
            446,
            8,
            38,
            121
        ],
        "1c5": [
            452,
            92,
            95
        ],
        "1c8": [
            12,
            53
        ],
        "1cc": [
            426,
            5
        ],
        "1cd": [
            462,
            458
        ],
        "1d5": [
            381,
            12,
            470
        ],
        "1d9": [
            470,
            12
        ],
        "1da": [
            8,
            14,
            13
        ],
        "1db": [
            14,
            13,
            69
        ],
        "1dc": [
            8,
            14,
            13,
            69
        ],
        "1e2": [
            481,
            477
        ],
        "1e3": [
            10,
            9
        ],
        "1e4": [
            10,
            452
        ],
        "1e7": [
            486,
            9
        ],
        "1eb": [
            486,
            485,
            9
        ],
        "1ec": [
            8,
            9
        ],
        "1ed": [
            14,
            12,
            13,
            3
        ],
        "1ee": [
            8,
            7,
            13,
            5,
            3
        ],
        "1ef": [
            7,
            13,
            5,
            3
        ],
        "1f4": [
            408,
            69
        ],
        "1f9": [
            403,
            3
        ],
        "1fd": [
            167,
            330
        ],
        "21b": [
            90,
            536
        ],
        "21c": [
            537,
            124
        ],
        "21d": [
            542,
            543
        ],
        "23a": [
            8,
            38,
            9
        ],
        "23b": [
            10,
            8,
            9
        ],
        "24c": [
            587,
            137
        ],
        "24e": [
            8,
            38
        ],
        "26a": [
            218,
            408,
            25,
            26
        ],
        "26f": [
            408,
            26,
            3
        ],
        "28a": [
            649,
            648
        ],
        "28c": [
            14,
            7,
            12,
            13
        ],
        "29c": [
            10,
            8,
            14,
            12,
            101,
            666
        ],
        "2a3": [
            674,
            183
        ],
        "2a4": [
            49,
            7,
            12
        ],
        "2ad": [
            686,
            687
        ],
        "2b3": [
            408,
            5
        ],
        "2b5": [
            692,
            694
        ],
        "2b9": [
            18,
            25,
            694
        ],
        "2ba": [
            152,
            409,
            3,
            4
        ],
        "2bb": [
            152,
            409,
            4
        ],
        "2bc": [
            409,
            4
        ],
        "2bf": [
            152,
            4
        ],
        "2c0": [
            409,
            5,
            3,
            4
        ],
        "2c1": [
            152,
            409,
            702,
            4
        ],
        "2c6": [
            709,
            13
        ],
        "2c7": [
            108,
            69
        ],
        "2cf": [
            13,
            708
        ],
        "2ea": [
            10,
            38
        ],
        "2eb": [
            12,
            101
        ],
        "2ee": [
            91,
            243
        ],
        "2ef": [
            42,
            315
        ],
        "2f2": [
            212,
            403
        ],
        "2f8": [
            11,
            759
        ],
        "2fa": [
            278,
            4
        ],
        "2fb": [
            21,
            7
        ],
        "2fd": [
            219,
            12
        ],
        "2fe": [
            219,
            14,
            13
        ],
        "2ff": [
            219,
            37
        ],
        "30b": [
            774,
            769
        ],
        "30c": [
            410,
            39
        ],
        "30d": [
            14,
            158,
            12,
            13,
            358,
            5,
            536,
            3
        ],
        "30e": [
            14,
            7,
            12,
            13,
            358,
            5,
            536,
            3
        ],
        "31f": [
            5,
            636
        ],
        "32b": [
            167,
            164
        ],
        "32c": [
            89,
            35,
            813
        ],
        "32e": [
            636,
            55
        ],
        "32f": [
            12,
            124
        ],
        "34b": [
            7,
            839
        ],
        "34d": [
            840,
            7,
            13
        ],
        "34e": [
            840,
            839
        ],
        "34f": [
            840,
            7
        ],
        "35b": [
            42,
            7
        ],
        "35c": [
            410,
            4
        ],
        "36a": [
            38,
            219,
            5
        ],
        "36b": [
            219,
            5
        ],
        "36e": [
            14,
            7
        ],
        "36f": [
            8,
            14,
            7,
            12,
            53
        ],
        "37e": [
            890,
            891
        ],
        "38b": [
            903,
            904,
            906
        ],
        "39b": [
            636,
            865
        ],
        "3a0": [
            808,
            636
        ],
        "3a1": [
            789,
            3
        ],
        "3a4": [
            933,
            793
        ],
        "3a6": [
            243,
            44
        ],
        "3a7": [
            793,
            3
        ],
        "3ab": [
            299,
            14
        ],
        "3b0": [
            941,
            943,
            942
        ],
        "3b1": [
            275,
            117
        ],
        "3b5": [
            10,
            101,
            559
        ],
        "3b8": [
            950,
            951
        ],
        "3b9": [
            950,
            12,
            951
        ],
        "3be": [
            38,
            639
        ],
        "3bf": [
            960,
            961,
            962
        ],
        "3c3": [
            110,
            147
        ],
        "3c4": [
            110,
            961,
            13
        ],
        "3c7": [
            943,
            275,
            277,
            117
        ],
        "3cb": [
            970,
            969
        ],
        "3ce": [
            25,
            636
        ],
        "3d1": [
            7,
            692,
            694
        ],
        "3d2": [
            7,
            694
        ],
        "3d5": [
            692,
            982
        ],
        "3d7": [
            219,
            14
        ],
        "3df": [
            219,
            985,
            989
        ],
        "3e7": [
            997,
            998
        ],
        "3ea": [
            992,
            9
        ],
        "3ed": [
            1004,
            1003
        ],
        "3f9": [
            1015,
            1016
        ],
        "3fa": [
            1014,
            865
        ],
        "3fb": [
            5,
            636,
            3
        ],
        "3fc": [
            1014,
            5,
            865
        ],
        "3ff": [
            12,
            101,
            102
        ],
        "40f": [
            925,
            1037,
            1038,
            1035,
            1040,
            1036
        ],
        "41f": [
            108,
            636
        ],
        "42b": [
            800,
            801
        ],
        "44a": [
            393,
            389,
            391
        ],
        "44b": [
            389,
            390
        ],
        "44c": [
            1014,
            670,
            692,
            1096,
            865
        ],
        "44d": [
            392,
            390
        ],
        "45b": [
            1114,
            13
        ],
        "46e": [
            128,
            3
        ],
        "47b": [
            1145,
            1146
        ],
        "47c": [
            636,
            789
        ],
        "47e": [
            1142,
            1144,
            1143
        ],
        "49b": [
            388,
            389
        ],
        "49f": [
            12,
            5,
            3
        ],
        "4a6": [
            190,
            410,
            47,
            32,
            39
        ],
        "4b0": [
            1198,
            1199
        ],
        "4b1": [
            292,
            236
        ],
        "4b3": [
            1204,
            1205
        ],
        "4b6": [
            388,
            389,
            391
        ],
        "4b8": [
            393,
            392
        ],
        "4c2": [
            389,
            391
        ],
        "4c7": [
            18,
            5
        ],
        "4c8": [
            1222,
            5
        ],
        "4cc": [
            128,
            392
        ],
        "4cd": [
            1187,
            3
        ],
        "4d0": [
            621,
            412
        ],
        "4d1": [
            37,
            636
        ],
        "4d2": [
            37,
            5
        ],
        "4d4": [
            18,
            25,
            26
        ],
        "4d5": [
            1157,
            621,
            412
        ],
        "4df": [
            1242,
            5
        ],
        "4e5": [
            1249,
            853,
            1250
        ],
        "4e6": [
            388,
            393,
            390
        ],
        "4e7": [
            388,
            393,
            389,
            390
        ],
        "4e8": [
            392,
            391
        ],
        "4ea": [
            1157,
            621
        ],
        "4eb": [
            1157,
            412
        ],
        "4ec": [
            14,
            390,
            5
        ],
        "4ed": [
            807,
            368
        ],
        "4ee": [
            1088,
            367,
            366
        ],
        "4ef": [
            532,
            9
        ],
        "4f1": [
            789,
            55
        ],
        "4f2": [
            789,
            1132,
            55
        ],
        "4fd": [
            1278,
            1279
        ],
        "50e": [
            884,
            5
        ],
        "50f": [
            7,
            13,
            5
        ],
        "51b": [
            1308,
            1309
        ],
        "52b": [
            25,
            26,
            3
        ],
        "53b": [
            1340,
            5
        ],
        "53d": [
            18,
            5,
            636
        ]
    }
    const titles = {
        "101": "Friendship is Magic, part 1",
        "102": "Friendship is Magic, part 2",
        "103": "The Ticket Master",
        "104": "Applebuck Season",
        "105": "Griffon the Brush Off",
        "106": "Boast Busters",
        "107": "Dragonshy",
        "108": "Look Before You Sleep",
        "109": "Bridle Gossip",
        "110": "Swarm of the Century",
        "111": "Winter Wrap Up",
        "112": "Call of the Cutie",
        "113": "Fall Weather Friends",
        "114": "Suited For Success",
        "115": "Feeling Pinkie Keen",
        "116": "Sonic Rainboom",
        "117": "Stare Master",
        "118": "The Show Stoppers",
        "119": "A Dog and Pony Show",
        "120": "Green Isn't Your Color",
        "121": "Over a Barrel",
        "122": "A Bird in the Hoof",
        "123": "The Cutie Mark Chronicles",
        "124": "Owl's Well That Ends Well",
        "125": "Party of One",
        "126": "The Best Night Ever",
        "201": "The Return of Harmony Part 1",
        "202": "The Return of Harmony Part 2",
        "203": "Lesson Zero",
        "204": "Luna Eclipsed",
        "205": "Sisterhooves Social",
        "206": "The Cutie Pox",
        "207": "May the Best Pet Win!",
        "208": "The Mysterious Mare Do Well",
        "209": "Sweet and Elite",
        "210": "Secret of My Excess",
        "211": "Hearth's Warming Eve",
        "212": "Family Appreciation Day",
        "213": "Baby Cakes",
        "214": "The Last Roundup",
        "215": "The Super Speedy Cider Squeezy 6000",
        "216": "Read It and Weep",
        "217": "Hearts and Hooves Day",
        "218": "A Friend in Deed",
        "219": "Putting Your Hoof Down",
        "220": "It's About Time",
        "221": "Dragon Quest",
        "222": "Hurricane Fluttershy",
        "223": "Ponyville Confidential",
        "224": "MMMystery on the Friendship Express",
        "225": "A Canterlot Wedding - Part 1",
        "226": "A Canterlot Wedding - Part 2",
        "301": "The Crystal Empire - Part 1",
        "302": "The Crystal Empire - Part 2",
        "303": "Too Many Pinkie Pies",
        "304": "One Bad Apple",
        "305": "Magic Duel",
        "306": "Sleepless in Ponyville",
        "307": "Wonderbolts Academy",
        "308": "Apple Family Reunion",
        "309": "Spike at Your Service",
        "310": "Keep Calm and Flutter On",
        "311": "Just for Sidekicks",
        "312": "Games Ponies Play",
        "313": "Magical Mystery Cure",
        "401": "Princess Twilight Sparkle - Part 1",
        "402": "Princess Twilight Sparkle - Part 2",
        "403": "Castle Mane-ia",
        "404": "Daring Don't",
        "405": "Flight to the Finish",
        "406": "Power Ponies",
        "407": "Bats!",
        "408": "Rarity Takes Manehattan",
        "409": "Pinkie Apple Pie",
        "410": "Rainbow Falls",
        "411": "Three's A Crowd",
        "412": "Pinkie Pride",
        "413": "Simple Ways",
        "414": "Filli Vanilli",
        "415": "Twilight Time",
        "416": "It Ain't Easy Being Breezies",
        "417": "Somepony to Watch Over Me",
        "418": "Maud Pie",
        "419": "For Whom the Sweetie Belle Toils",
        "420": "Leap of Faith",
        "421": "Testing Testing 1, 2, 3",
        "422": "Trade Ya!",
        "423": "Inspiration Manifestation",
        "424": "Equestria Games",
        "425": "Twilight's Kingdom - Part 1",
        "426": "Twilight's Kingdom - Part 2",
        "501": "The Cutie Map - Part 1",
        "502": "The Cutie Map - Part 2",
        "503": "Castle Sweet Castle",
        "504": "Bloom & Gloom",
        "505": "Tanks for the Memories",
        "506": "Appleoosa's Most Wanted",
        "507": "Make New Friends but Keep Discord",
        "508": "The Lost Treasure of Griffonstone",
        "509": "Slice of Life",
        "510": "Princess Spike",
        "511": "Party Pooped",
        "512": "Amending Fences",
        "513": "Do Princesses Dream of Magic Sheep?",
        "514": "Canterlot Boutique",
        "515": "Rarity Investigates!",
        "516": "Made in Manehattan",
        "517": "Brotherhooves Social",
        "518": "Crusaders of the Lost Mark",
        "519": "The One Where Pinkie Pie Knows",
        "520": "Hearthbreakers",
        "521": "Scare Master",
        "522": "What About Discord?",
        "523": "The Hooffields and McColts",
        "524": "The Mane Attraction",
        "525": "The Cutie Re-Mark - Part 1",
        "526": "The Cutie Re-Mark - Part 2",
        "601": "The Crystalling - Part 1",
        "602": "The Crystalling - Part 2",
        "603": "The Gift of the Maud Pie",
        "604": "On Your Marks",
        "605": "Gauntlet of Fire",
        "606": "No Second Prances",
        "607": "Newbie Dash",
        "608": "A Hearth's Warming Tail",
        "609": "The Saddle Row Review",
        "610": "Applejack's \"Day\" Off",
        "611": "Flutter Brutter",
        "612": "Spice Up Your Life",
        "613": "Stranger Than Fan Fiction",
        "614": "The Cart Before the Ponies",
        "615": "28 Pranks Later",
        "616": "The Times They Are A Changeling",
        "617": "Dungeons & Discords",
        "618": "Buckball Season",
        "619": "The Fault in Our Cutie Marks",
        "620": "Viva Las Pegasus",
        "621": "Every Little Thing She Does",
        "622": "P.P.O.V. (Pony Point of View)",
        "623": "Where the Apple Lies",
        "624": "Top Bolt",
        "625": "To Where and Back Again - Part 1",
        "626": "To Where and Back Again - Part 2",
        "701": "Celestial Advice",
        "702": "All Bottled Up",
        "703": "A Flurry of Emotions",
        "704": "Rock Solid Friendship",
        "705": "Fluttershy Leans In",
        "706": "Forever Filly",
        "707": "Parental Glideance",
        "708": "Hard to Say Anything",
        "709": "Honest Apple",
        "710": "A Royal Problem",
        "711": "Not Asking for Trouble",
        "712": "Discordant Harmony",
        "713": "The Perfect Pear",
        "714": "Fame and Misfortune",
        "715": "Triple Threat",
        "716": "Campfire Tales",
        "717": "To Change a Changeling",
        "718": "Daring Done?",
        "719": "It Isn't the Mane Thing About You",
        "720": "A Health of Information",
        "721": "Marks and Recreation",
        "722": "Once Upon a Zeppelin",
        "723": "Secrets and Pies",
        "724": "Uncommon Bond",
        "725": "Shadow Play - Part 1",
        "726": "Shadow Play - Part 2",
        "801": "School Daze - Part 1",
        "802": "School Daze - Part 2",
        "803": "The Maud Couple",
        "804": "Fake It 'Til You Make It",
        "805": "Grannies Gone Wild",
        "806": "Surf and or Turf",
        "807": "Horse Play",
        "808": "The Parent Map",
        "809": "Non-Compete Clause",
        "810": "The Break Up Break Down",
        "811": "Molt Down",
        "812": "Marks for Effort",
        "813": "The Mean 6",
        "814": "A Matter of Principals",
        "815": "The Hearth's Warming Club",
        "816": "Friendship University",
        "817": "The End in Friend",
        "818": "Yakity-Sax",
        "819": "Road to Friendship",
        "820": "The Washouts",
        "821": "A Rockhoof and a Hard Place",
        "822": "What Lies Beneath",
        "823": "Sounds of Silence",
        "824": "Father Knows Beast",
        "825": "School Raze - Part 1",
        "826": "School Raze - Part 2",
        "901": "The Beginning of the End - Part 1",
        "902": "The Beginning of the End - Part 2",
        "903": "Uprooted",
        "904": "Sparkle's Seven",
        "905": "The Point of No Return",
        "906": "Common Ground",
        "907": "She's All Yak",
        "908": "Frenemies",
        "909": "Sweet and Smoky",
        "910": "Going to Seed",
        "911": "Student Counsel",
        "912": "The Last Crusade",
        "913": "Between Dark and Dawn",
        "914": "The Last Laugh",
        "915": "2, 4, 6, Greaaat",
        "916": "A Trivial Pursuit",
        "917": "The Summer Sun Setback",
        "918": "She Talks to Angel",
        "919": "Dragon Dropped",
        "920": "A Horse Shoe-In",
        "921": "Daring Doubt",
        "922": "Growing Up is Hard to Do",
        "923": "The Big Mac Question",
        "924": "The Ending of the End - Part 1",
        "925": "The Ending of the End - Part 2",
        "926": "The Last Problem",
        "927": "A-Dressing Memories",
        "928": "Cakes for the Memories",
        "929": "Memnagerie",
        "930": "Deep Tissue Memories",
        "931": "Harvesting Memories",
        "932": "Memories and More"
    }
    const colours = ["#883E97", "#EC0B8F", "#EF67A5", "#3C0F62", "#00B1CC"];
</script>
<script>
    function getColour(index) {
        return colours[Number(index) % colours.length];
    }
    function parseLine(line) {
        return {
            episode: `Season ${line.slice(0, 1)}, Episode ${line.slice(1, 3)} - ${titles[line.slice(0, 3)] || "Unknown Title"}`,
            speaker: speakers[parseInt(line.slice(3, 6), 16)],
            text: line.slice(7).trim().replace(/\[/g, "<i>[").replace(/\]/g, "]</i>")
        }
    }

    document.querySelector("form").addEventListener("submit", async (e) => {
        e.preventDefault(); // prevent page reload

        const form = e.target;
        const formData = new FormData(form);

        let searchButton = document.querySelector("button[type=submit]");
        searchButton.disabled = true; // disable submit button to prevent spamming search queries
        searchButton.innerHTML = `<img src="./loading.gif"> Searching...`

        const res = await fetch("/search", {
            method: "POST",
            body: formData,
        });

        if (!res.ok) {
            console.error("Error:", res.status);
            return;
        }

        searchButton.innerHTML = `&#x1F50D;&#xFE0E; Search`
        searchButton.disabled = false;

        const results = await res.json(); // <-- process JSON response

        function display(results, query = document.querySelector("#queryField").value) {
            document.querySelector("div#results").innerHTML = ""; // clear previous results
            let currentPage = 0
            function render() {
                results.slice(currentPage * 20, (++currentPage) * 20).forEach(scene => {
                    let lines = scene.map(parseLine)
                    let episode = lines[4].episode;
                    let script = lines.map((line, i) => {
                        return (line.speaker !== "Unknown" ? `<p><b>${line.speaker}</b>: ` : "<p>") + (query ? line.text.replace(new RegExp(`\\b(${query})\\b`, "gi"), `<span class="match">$1</span>`) : line.text) + "</p>"
                    }).join("");
                    let colour = getColour(scene[4].slice(0, 1))
                    document.querySelector("div#results").innerHTML += `
                        <details open style="border-color: ${colour};">
                            <summary style="background-color: ${colour};" onclick="window.scrollTo({ top: this.getBoundingClientRect().top + window.scrollY - 30 });"><h3>${episode}</h3></summary>
                            ${script}
                        </details>`;
                });
            }

            let loadMoreButton = document.querySelector("button#loadMore");
            loadMoreButton.onclick = render
            loadMoreButton.style.display = "block"; // show the load more button
            render(); // initial render
        }

        document.querySelector("div#phrases").innerHTML = ""; // clear previous sentence blocks
        if (formData.get("mode") === "sentence") {
            let emptyResults = results.filter(result => result.scenes.length === 0)
            if (emptyResults.length > 0) { // Some phrases have no results
                document.querySelector("div#results").innerHTML = `<p>No results found for "${emptyResults[0].phrase.split(" ")[0]}".</p>`;
            } else {
                results.forEach((result, i) => {
                    let button = document.createElement("button");
                    button.innerHTML = result.phrase
                    button.addEventListener("click", display.bind(null, result.scenes, result.phrase));
                    document.querySelector("div#phrases").appendChild(button);
                })
                display(results[0].scenes, results[0].phrase);
            }
        } else {
            if (results.length === 0) {
                document.querySelector("div#results").innerHTML = "<p>No results found.</p>";
            } else {
                display(results)
            }
        }
    });

    // Speaker search
    let imgLinkCache = {}
    document.querySelector("#speakerField").addEventListener("input", async (e) => {
        let value = e.target.value.toLowerCase().replaceAll(/ /g, "_")
        let datalist = document.querySelector("#speakersList");
        let candidates = [];
        if (value.length > 0) {
            await fetch(`https://ponyapi.net/v1/character/${value}?limit=10`).then(res => res.json()).then(res => { candidates = res.data });
            datalist.innerHTML = "";
            candidates.forEach(speaker => {
                let option = document.createElement("option");
                option.value = speaker.name;
                datalist.appendChild(option);

                imgLinkCache[speaker.name] = speaker.image[0];
            });
        } else {
            datalist.innerHTML = `<option value="Any" selected><option value="Twilight Sparkle"><option value="Applejack"><option value="Fluttershy"><option value="Rarity"><option value="Pinkie Pie"><option value="Rainbow Dash">`;
        }
    });
    document.querySelector("#speakerField").addEventListener("change", async (e) => {
        // Somehow hide the datalist until next focus
        let value = e.target.value;
        if (value in imgLinkCache) {
            fetch(imgLinkCache[value]).then(res => res.blob()).then(blob => {
                let imgURL = URL.createObjectURL(blob);
                let img = document.querySelector("#speakerImg");
                img.src = imgURL;
            });
        }
    })
</script>

</html>